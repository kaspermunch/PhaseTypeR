---
title: "Phasty v0.1"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Phasty}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, setup}
library(phasty)
```

# Informations

Please report any issue on the git page of the package ...

# Introduction

What is the topic
why a package 
based on what
What does it contains

# The phase-type class object

The package use several new classes for describing a phase-type distributed object, which are: "disc_phase_type", "cont_phase_type", "mult_disc_phase_type", "mult_cont_phase_type". Which can be obtain using the following functions respectively:

```{r, eval = F}
X1 <- disc_phase_type(subint_mat = NULL, init_probs = NULL)

X2 <- cont_phase_type(subint_mat = NULL, init_probs = NULL)

Y1 <- mult_disc_phase_type(subint_mat = NULL, init_probs = NULL, reward_mat = NULL)

Y2 <- mult_cont_phase_type(subint_mat = NULL, init_probs = NULL, reward_mat = NULL)
```

Those classes will be necessary later on to recognise the type of object for function like mean or var.

# The univariate distribution

## The continuous univariate phase-type
### A few reminders

For a deep understanding of the continuous phase-type distribution, we deeply advise the reader to take a look at the book of Bladt and Nielsen 2007 [PUT THE REF]

Let's consider $\{ X_t \}_{t \ge 0}$ a Markov jump process with $p$ transient states and 1 absorbing state, we can write the state space of $\{ X_t \}_{t \ge 0}$ as $E = (1,\, 2,\, 3,\, ...,\, p,\, p+1)$.
This means that $\{ X_t \}_{t \ge 0}$ will stay in the different transient states until it reachs the absorbing states from which it cannot go out.
For a Markov jump process the time of transition bewteen each state follow a exponential distribution with a rate $\lambda$. The intensity matrix summarize the transition rate with the rate $\lambda_{i,j}$ in row $i$ and column $j$ corresponds to the transition rate from state $i$ to state $j$.
In the case where there are $p$ transient state and 1 absorbing state, the intensity matrix can be written:
$$
\boldsymbol{\Lambda} = 
\left(\begin{array}{cc} 
\boldsymbol{T} & \boldsymbol{t} \\
\boldsymbol{0} & 0
\end{array}\right)
$$ 
Where $\boldsymbol{T}$ is the subintensity matrix, i.e. the intensity matrix between the transient states only and $\boldsymbol{t}$ is the exit rate, i.e. the transition rate between the transient states and the abosrbing state.

If we take a look at the subintensity matrix $\boldsymbol{T}$, we will have a negative diagonal corresponding to the rate at which $\{ X_t \}_{t \ge 0}$ will leave the state $i$. The other cell of the matrix should be non positive and will contain the transition rate from one transient state to another. Also the rowsum should be non-positive, and the vector of absolute value of the rowsum correspond to the exit rate vector. Because of that we can note:
$$
\boldsymbol{t} = -\boldsymbol{Te},
$$ 

Where $\boldsymbol{e}$ is vector of 1 of length $p$.

looking at the phase-type distribution of $\{ X_t \}_{t \ge 0}$ corresponds to the probability that the time to reach the absorbing state is $t$.

Given a variable $X$ following a continuous phase-type distribution, $X\sim PH(\boldsymbol{T}, \boldsymbol{\pi})$ where $\boldsymbol{T}$ is the subintensity matrix and $\boldsymbol{\pi}$ the initial probability vector.

### The functions

Let's take a little example to explain how to use the different functions

```{r}
subintensity_matrix = matrix(c(-1.5, 0, 0,
                              1.5, -1, 0,
                              0, 1, -0.5), ncol = 3)
initial_probabilities = c(0.9, 0.1, 0)

X = cont_phase_type(subintensity_matrix, initial_probabilities)
print(X)
```

The initial probability are optional, if they are not provided, the initial probability vector will be $\pi = (1,\, 0,\, 0,\, ...)$.

Now that we have a phase-type distributed variable we can apply some basic function as follow 

```{r}
cat('Mean: ',mean(X),'\n')
cat('Variance: ',var(X),'\n \n')

cat('Summary: \n-------------')
summary(X)
cat('-------------')
```

It is possible to give to each transient state a weight by a reward 
transformation, to do so we will use a reward vector of size $p$

```{r}
r = c(1,0,4)

Y = cont_reward(phase_type = X, reward = r)
print(Y)
```
## The discrete univariate phase-type

# The multivariate distribution
## The continuous multivariate


## The discrete multivariate


# The discrete phase-type distribution


