<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Transformation of Phase-Type Distributions via Rewards — reward_phase_type • PhaseTypeR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Transformation of Phase-Type Distributions via Rewards — reward_phase_type" />
<meta property="og:description" content="Transform a variable following a phase-type distribution according to a
non-negative reward vector." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhaseTypeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/PhaseTypeR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/phasty_SFS.html">Using PhaseTypeR for the site frequency spectrum</a>
    </li>
    <li>
      <a href="../articles/phasty_SFS_Figures.html">Using PhaseTypeR for the site frequency spectrum - Figures</a>
    </li>
    <li>
      <a href="../articles/pop_gen_iker.html">Using PhaseTypeR for population genetics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rivasiker/PhaseTypeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transformation of Phase-Type Distributions via Rewards</h1>
    <small class="dont-index">Source: <a href='https://github.com/rivasiker/PhaseTypeR/blob/master/R/reward_phase_type.R'><code>R/reward_phase_type.R</code></a></small>
    <div class="hidden name"><code>reward_phase_type.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform a variable following a phase-type distribution according to a
non-negative reward vector.</p>
    </div>

    <pre class="usage"><span class='fu'>reward_phase_type</span><span class='op'>(</span><span class='va'>phase_type</span>, <span class='va'>reward</span>, round_zero <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>phase_type</th>
      <td><p>an object of class <code>cont_phase_type</code> or
<code>disc_phase_type</code>.</p></td>
    </tr>
    <tr>
      <th>reward</th>
      <td><p>a vector of the same length as the number of
states. The vector should contains non negative values and only integer for
discrete phase-type class.
For <code>disc_phase_type</code> object, it could also be a matrix with as many
rows as states and as many columns as the maximum values of reward plus one.
Also in this case, each cell of the matrix should be probabilities and the
sum of the rows should sum up to one.</p></td>
    </tr>
    <tr>
      <th>round_zero</th>
      <td><p>is a positive integer or <code>NULL</code>, if it is a positive
integer, all the values in the subintensity matrix and initial probabilities
will be truncate at the corresponding decimal. It can be useful if
the computational approximation of some values leads the row
sums of the subintensity  matrix to be higher than 1 or smaller than 0 for
discrete cases, or higher than 0 for continuous cases.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>disc_phase_type</code> or <code>cont_phase_type</code>.
Be aware that if the input is a multivariate phase_type the output will be
univariate.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the reward transformation for continuous phase-type distribution, the
transformation will be performed as presented in the book of Bladt and
Nielsen (2017).</p>
<p>For the discrete phase_type distribution is based on the PhD of Navarro (2018) and
Hobolth, Bladt and Andersen (2021).</p>
<p>Every state of the subintensity matrix should have a reward, in the case of
continuous phase-type, this reward should be a vector with non negative
values of a size equal to the number of states.</p>
<p>For the discrete phase-type, the reward could be also a vector but containing
only non-negatives integer.
Also it can be me a matrix, in that case the matrix should have as many rows
as the number of states, and the column 1 to j+1 corresponds to reward of
0 to j. Each cell corresponding that entering in the state i, the probability
that we attribute to this state a reward j corresponds to the value of the
matrix in row i and column j+1.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bladt, M., &amp; Nielsen, B. F. (2017). *Matrix-exponential distributions in applied probability* (Vol. 81). New York: Springer.
Campillo Navarro, A. (2018). *Order statistics and multivariate discrete phase-type distributions*. DTU Compute. DTU Compute PHD-2018, Vol.. 492
Hobolth, A., Bladt, M. &amp; Andersen, L.A. (2021). *Multivariate phase-type theory for the site frequency spectrum*. ArXiv.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='phase_type.html'>phase_type</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>C. Guetemme, A. Hobolth</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##===========================##</span>
<span class='co'>## For continuous phase-type ##</span>
<span class='co'>##===========================##</span>

<span class='va'>subint_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>,
                      <span class='fl'>2</span>, <span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>0</span>,
                      <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>3</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>init_probs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>ph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='generator_functions.html'>PH</a></span><span class='op'>(</span><span class='va'>subint_mat</span>, <span class='va'>init_probs</span><span class='op'>)</span>
<span class='va'>reward</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>

<span class='fu'>reward_phase_type</span><span class='op'>(</span><span class='va'>ph</span>, <span class='va'>reward</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $subint_mat
#&gt;           [,1]      [,2]
#&gt; [1,] -4.666667  3.333333
#&gt; [2,]  0.250000 -0.750000
#&gt; 
#&gt; $init_probs
#&gt;           [,1]       [,2]
#&gt; [1,] 0.9333333 0.03333333
#&gt; 
#&gt; $defect
#&gt; [1] 0.03333333
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "cont_phase_type"</div><div class='input'>
<span class='co'>##=========================##</span>
<span class='co'>## For discrete phase-type ##</span>
<span class='co'>##=========================##</span>

<span class='va'>subint_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='fl'>0</span>, <span class='fl'>0</span>,
                      <span class='fl'>0.24</span>, <span class='fl'>0.4</span>, <span class='fl'>0</span>,
                      <span class='fl'>0.12</span>, <span class='fl'>0.2</span>, <span class='fl'>0.5</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>init_probs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='va'>ph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='generator_functions.html'>DPH</a></span><span class='op'>(</span><span class='va'>subint_mat</span>, <span class='va'>init_probs</span><span class='op'>)</span>

<span class='va'>reward</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>4</span><span class='op'>)</span>

<span class='fu'>reward_phase_type</span><span class='op'>(</span><span class='va'>ph</span>, <span class='va'>reward</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $subint_mat
#&gt;      [,1] [,2] [,3] [,4] [,5]
#&gt; [1,]  0.4  0.2    0    0    0
#&gt; [2,]  0.0  0.0    1    0    0
#&gt; [3,]  0.0  0.0    0    1    0
#&gt; [4,]  0.0  0.0    0    0    1
#&gt; [5,]  0.0  0.5    0    0    0
#&gt; 
#&gt; $init_probs
#&gt;      [,1]       [,2] [,3] [,4] [,5]
#&gt; [1,]  0.9 0.03333333    0    0    0
#&gt; 
#&gt; $defect
#&gt; [1] 0.06666667
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "disc_phase_type"</div><div class='input'>
<span class='co'>#---</span>

<span class='va'>subint_mat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.4</span>, <span class='fl'>0</span>, <span class='fl'>0.5</span>,
                      <span class='fl'>0.2</span>, <span class='fl'>0.24</span>, <span class='fl'>0</span>,
                      <span class='fl'>0.4</span>, <span class='fl'>0.6</span>, <span class='fl'>0.2</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>init_probs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span><span class='op'>)</span>

<span class='va'>ph</span> <span class='op'>&lt;-</span> <span class='fu'><a href='generator_functions.html'>DPH</a></span><span class='op'>(</span><span class='va'>subint_mat</span>, <span class='va'>init_probs</span><span class='op'>)</span>

<span class='va'>reward</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.2</span>, <span class='fl'>1</span>,
                   <span class='fl'>0.5</span>, <span class='fl'>0</span>, <span class='fl'>0</span>,
                   <span class='fl'>0.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0</span>,
                   <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>,
                   <span class='fl'>0</span>, <span class='fl'>0.2</span>, <span class='fl'>0</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>

<span class='fu'>reward_phase_type</span><span class='op'>(</span><span class='va'>ph</span>, <span class='va'>reward</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $subint_mat
#&gt;           [,1]      [,2]       [,3] [,4]      [,5] [,6]
#&gt; [1,] 0.0000000 1.0000000 0.00000000    0 0.0000000    0
#&gt; [2,] 0.3328782 0.3328782 0.04201681    0 0.1260504    0
#&gt; [3,] 0.0000000 0.0000000 0.00000000    1 0.0000000    0
#&gt; [4,] 0.0000000 0.0000000 0.00000000    0 1.0000000    0
#&gt; [5,] 0.0000000 0.0000000 0.00000000    0 0.0000000    1
#&gt; [6,] 0.1969538 0.1969538 0.05042017    0 0.1512605    0
#&gt; 
#&gt; $init_probs
#&gt;           [,1]        [,2]      [,3] [,4]       [,5] [,6]
#&gt; [1,] 0.9039391 0.003939076 0.0810084    0 0.00302521    0
#&gt; 
#&gt; $defect
#&gt; [1] 0.008088235
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "disc_phase_type"</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Iker Rivas-González, Colin Guetemme, Asger Hobolth, Lars Nørvang Andersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


