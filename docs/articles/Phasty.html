<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phasty v0.1 • phasty</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Phasty v0.1">
<meta property="og:description" content="phasty">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phasty</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Phasty.html">Phasty v0.1</a>
    </li>
    <li>
      <a href="../articles/Population_genetics.html">Population_genetics</a>
    </li>
    <li>
      <a href="../articles/Populations_genetics.html">Phase-type application to coalescent theory</a>
    </li>
    <li>
      <a href="../articles/pop_gen_iker.html">Using phasty for population genetics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rivasiker/phasty/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Phasty v0.1</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rivasiker/phasty/blob/master/vignettes/Phasty.Rmd"><code>vignettes/Phasty.Rmd</code></a></small>
      <div class="hidden name"><code>Phasty.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">phasty</span>)
<span class="co">#&gt; Loading required package: expm</span>
<span class="co">#&gt; Loading required package: Matrix</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'expm'</span>
<span class="co">#&gt; The following object is masked from 'package:Matrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expm</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'phasty'</span>
<span class="co">#&gt; The following object is masked from 'package:Matrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     mean</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     var</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     mean</span></pre></body></html></div>
<div id="informations" class="section level1">
<h1 class="hasAnchor">
<a href="#informations" class="anchor"></a>Informations</h1>
<p>Please report any issues on the git page of the package …</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Phase-type distributions is an important mathematical tool especially in fields like insurance or population genetics.</p>
<p>The basic idea is considering a markov jump process (or a Markov chain for discrete cases) with <span class="math inline">\(n\)</span> transient states and 1 absorbing state (i.e. once in the absorbing state, it cannot go out), you can have the time before reaching that absorbing state using with the intensity matrix and the initial probabilities to start in each state. The matrix form of pahse-type distribution allow great simplification in some calculus, in particular to find the moments of the time before reaching the absorbing state.</p>
<p>The package  handle this phase-type distribution and the calculation behind it.</p>
<p>This package is a complete as possible, nevertheless, it stays a package which bring mathematical tools and its not oriented for a specific application.</p>
<p>The main references that have been used for this package are:</p>
</div>
<div id="the-phase-type-s3-class-object" class="section level1">
<h1 class="hasAnchor">
<a href="#the-phase-type-s3-class-object" class="anchor"></a>The phase-type S3 class object</h1>
<p>The package use several new classes for describing a phase-type distributed object, which are: “disc_phase_type”, "cont_phase _type“,”mult_disc_phase_type“,”mult_cont_phase_type". Which can be obtain using , here is an example considering a univariate continuous phase_type distribution:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">subintensity_matrix</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">0</span>,
                              <span class="fl">1.5</span>, -<span class="fl">1</span>, <span class="fl">0</span>,
                              <span class="fl">0</span>, <span class="fl">1</span>, -<span class="fl">0.5</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">initial_probabilities</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>, <span class="fl">0</span>)
<span class="no">ph</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/phase_type.html">phase_type</a></span>(<span class="no">subintensity_matrix</span>, <span class="no">initial_probabilities</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">ph</span>)
<span class="co">#&gt; $subint_mat</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] -1.5  1.5  0.0</span>
<span class="co">#&gt; [2,]  0.0 -1.0  1.0</span>
<span class="co">#&gt; [3,]  0.0  0.0 -0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $init_probs</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]  0.9  0.1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $defect</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cont_phase_type"</span></pre></body></html></div>
<p>With  the subintensity matrix and  the vector of initials probabilities. An object of one of the phase_type class should have a subintensity matrix, a initial probability vector, a defect being the probability to start directly in the absorbing state, which can happens when using reward transformation (see section )) and the type of class.</p>
<p>The init_probs are optional in the inputs, in that case the probability to start in the first state will be 1.</p>
<p>Those classes will be necessary later on to recognise the type of object for function like mean or var.</p>
</div>
<div id="the-univariate-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#the-univariate-distribution" class="anchor"></a>The univariate distribution</h1>
<div id="the-continuous-univariate-phase-type" class="section level2">
<h2 class="hasAnchor">
<a href="#the-continuous-univariate-phase-type" class="anchor"></a>The continuous univariate phase-type</h2>
<div id="a-few-reminders" class="section level3">
<h3 class="hasAnchor">
<a href="#a-few-reminders" class="anchor"></a>A few reminders</h3>
<p>For a deep understanding of the continuous phase-type distribution, we deeply advise the reader to take a look at the book of Bladt and Nielsen 2007 [PUT THE REF]</p>
<p>Let’s consider <span class="math inline">\(\{ X_t \}_{t \ge 0}\)</span> a Markov jump process with <span class="math inline">\(p\)</span> transient states and 1 absorbing state, we can write the state space of <span class="math inline">\(\{ X_t \}_{t \ge 0}\)</span> as <span class="math inline">\(E = (1,\, 2,\, 3,\, ...,\, p,\, p+1)\)</span>. This means that <span class="math inline">\(\{ X_t \}_{t \ge 0}\)</span> will stay in the different transient states until it reachs the absorbing states from which it cannot go out. For a Markov jump process the time of transition bewteen each state follow a exponential distribution with a rate <span class="math inline">\(\lambda\)</span>. The intensity matrix summarize the transition rate with the rate <span class="math inline">\(\lambda_{i,j}\)</span> in row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span> corresponds to the transition rate from state <span class="math inline">\(i\)</span> to state <span class="math inline">\(j\)</span>. In the case where there are <span class="math inline">\(p\)</span> transient state and 1 absorbing state, the intensity matrix can be written: <span class="math display">\[
\boldsymbol{\Lambda} = 
\left(\begin{array}{cc} 
\boldsymbol{T} &amp; \boldsymbol{t} \\
\boldsymbol{0} &amp; 0
\end{array}\right)
\]</span> Where <span class="math inline">\(\boldsymbol{T}\)</span> is the subintensity matrix, i.e. the intensity matrix between the transient states only and <span class="math inline">\(\boldsymbol{t}\)</span> is the exit rate, i.e. the transition rate between the transient states and the abosrbing state.</p>
<p>If we take a look at the subintensity matrix <span class="math inline">\(\boldsymbol{T}\)</span>, we will have a negative diagonal corresponding to the rate at which <span class="math inline">\(\{ X_t \}_{t \ge 0}\)</span> will leave the state <span class="math inline">\(i\)</span>. The other cell of the matrix should be non positive and will contain the transition rate from one transient state to another. Also the rowsum should be non-positive, and the vector of absolute value of the rowsum correspond to the exit rate vector. Because of that we can note: <span class="math display">\[
\boldsymbol{t} = -\boldsymbol{Te},
\]</span></p>
<p>Where <span class="math inline">\(\boldsymbol{e}\)</span> is vector of 1 of length <span class="math inline">\(p\)</span>.</p>
<p>looking at the phase-type distribution of <span class="math inline">\(\{ X_t \}_{t \ge 0}\)</span> corresponds to the probability that the time to reach the absorbing state is <span class="math inline">\(t\)</span>.</p>
<p>Given a variable <span class="math inline">\(X\)</span> following a continuous phase-type distribution, <span class="math inline">\(X\sim PH(\boldsymbol{T}, \boldsymbol{\pi})\)</span> where <span class="math inline">\(\boldsymbol{T}\)</span> is the subintensity matrix and <span class="math inline">\(\boldsymbol{\pi}\)</span> the initial probability vector.</p>
</div>
<div id="the-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#the-functions" class="anchor"></a>The functions</h3>
<p>Let’s take the same example as before to explain how to use the different functions:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">subintensity_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">0</span>,
                              <span class="fl">1.5</span>, -<span class="fl">1</span>, <span class="fl">0</span>,
                              <span class="fl">0</span>, <span class="fl">1</span>, -<span class="fl">0.5</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">initial_probabilities</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>, <span class="fl">0</span>)
<span class="no">ph</span> <span class="kw">=</span> <span class="fu"><a href="../reference/phase_type.html">phase_type</a></span>(<span class="no">subintensity_matrix</span>, <span class="no">initial_probabilities</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">ph</span>)
<span class="co">#&gt; $subint_mat</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] -1.5  1.5  0.0</span>
<span class="co">#&gt; [2,]  0.0 -1.0  1.0</span>
<span class="co">#&gt; [3,]  0.0  0.0 -0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $init_probs</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]  0.9  0.1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $defect</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cont_phase_type"</span></pre></body></html></div>
<p>The initial probability are optional, if they are not provided, the initial probability vector will be <span class="math inline">\(\pi = (1,\, 0,\, 0,\, ...)\)</span>.</p>
<p>Now that we have a phase-type distributed variable we can apply some basic function as follow</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'Mean: '</span>,<span class="fu"><a href="../reference/mean.html">mean</a></span>(<span class="no">ph</span>),<span class="st">'\n'</span>)
<span class="co">#&gt; Mean:  3.6</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'Variance: '</span>,<span class="fu"><a href="../reference/var.html">var</a></span>(<span class="no">ph</span>),<span class="st">'\n \n'</span>)
<span class="co">#&gt; Variance:  5.44 </span>
<span class="co">#&gt; </span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'Summary: \n-------------'</span>)
<span class="co">#&gt; Summary: </span>
<span class="co">#&gt; -------------</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">ph</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Subintensity matrix:</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,] -1.5  1.5  0.0</span>
<span class="co">#&gt; [2,]  0.0 -1.0  1.0</span>
<span class="co">#&gt; [3,]  0.0  0.0 -0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initial probabilities:</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]  0.9  0.1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Defect:</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean: 3.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variance: 5.44</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'-------------'</span>)
<span class="co">#&gt; -------------</span></pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.1</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">dphtype</a></span>(<span class="no">x</span>, <span class="no">ph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'density probability'</span>)</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">pphtype</a></span>(<span class="no">x</span>, <span class="no">ph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'cumulated density probability'</span>)</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">qphtype</a></span>(<span class="no">y</span>, <span class="no">ph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'quantile'</span>)</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'10 random samples: \n \n'</span>, <span class="fu"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="fl">5</span>, <span class="no">ph</span>), <span class="st">'\n'</span>, <span class="fu"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="fl">5</span>, <span class="no">ph</span>))
<span class="co">#&gt; 10 random samples: </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  5.078757 1.485009 2.449289 3.652611 2.334932 </span>
<span class="co">#&gt;  3.574192 2.127139 5.504208 0.3806223 5.073861</span></pre></body></html></div>
<p>It is possible to give to each transient state a weight by a reward transformation, to do so we will use a reward vector of size <span class="math inline">\(p\)</span></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">r</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">4</span>)

<span class="no">Y</span> <span class="kw">=</span> <span class="fu"><a href="../reference/reward_phase_type.html">reward_phase_type</a></span>(<span class="kw">phase_type</span> <span class="kw">=</span> <span class="no">ph</span>, <span class="kw">reward</span> <span class="kw">=</span> <span class="no">r</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">Y</span>)
<span class="co">#&gt; $subint_mat</span>
<span class="co">#&gt;      [,1]   [,2]</span>
<span class="co">#&gt; [1,] -1.5  1.500</span>
<span class="co">#&gt; [2,]  0.0 -0.125</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $init_probs</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]  0.9  0.1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $defect</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "cont_phase_type"</span></pre></body></html></div>
</div>
</div>
<div id="the-discrete-univariate-phase-type" class="section level2">
<h2 class="hasAnchor">
<a href="#the-discrete-univariate-phase-type" class="anchor"></a>The discrete univariate phase-type</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">subintensity_matrix</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.4</span>, <span class="fl">0</span>, <span class="fl">0</span>,
                              <span class="fl">0.24</span>, <span class="fl">0.4</span>, <span class="fl">0</span>,
                              <span class="fl">0.12</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="no">initial_probabilities</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.1</span>, <span class="fl">0</span>)
<span class="no">dph</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/phase_type.html">phase_type</a></span>(<span class="no">subintensity_matrix</span>, <span class="no">initial_probabilities</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">dph</span>)
<span class="co">#&gt; $subint_mat</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]  0.4 0.24 0.12</span>
<span class="co">#&gt; [2,]  0.0 0.40 0.20</span>
<span class="co">#&gt; [3,]  0.0 0.00 0.50</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $init_probs</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]  0.9  0.1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $defect</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "disc_phase_type"</span></pre></body></html></div>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">1</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">dphtype</a></span>(<span class="no">x</span>, <span class="no">dph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'density probability'</span>,
        <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><html><body><pre class="r">
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">pphtype</a></span>(<span class="no">x</span>, <span class="no">dph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'cumulated density probability'</span>, <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>))</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><html><body><pre class="r">
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)
<span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/dphtype.html">qphtype</a></span>(<span class="no">y</span>, <span class="no">dph</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">x</span>, <span class="no">y</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">'time before absorbing state'</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">'quantile'</span>)</pre></body></html></div>
<p><img src="Phasty_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">'10 random samples: \n \n'</span>, <span class="fu"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="fl">5</span>, <span class="no">dph</span>), <span class="st">'\n'</span>, <span class="fu"><a href="../reference/dphtype.html">rphtype</a></span>(<span class="fl">5</span>, <span class="no">dph</span>))
<span class="co">#&gt; 10 random samples: </span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  1 1 2 4 2 </span>
<span class="co">#&gt;  1 5 2 1 5</span></pre></body></html></div>
</div>
</div>
<div id="the-multivariate-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#the-multivariate-distribution" class="anchor"></a>The multivariate distribution</h1>
<div id="the-continuous-multivariate" class="section level2">
<h2 class="hasAnchor">
<a href="#the-continuous-multivariate" class="anchor"></a>The continuous multivariate</h2>
</div>
<div id="the-discrete-multivariate" class="section level2">
<h2 class="hasAnchor">
<a href="#the-discrete-multivariate" class="anchor"></a>The discrete multivariate</h2>
</div>
</div>
<div id="the-discrete-phase-type-distribution" class="section level1">
<h1 class="hasAnchor">
<a href="#the-discrete-phase-type-distribution" class="anchor"></a>The discrete phase-type distribution</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iker Rivas-González, Colin Guetemme, Asger Hobolth, Lars Nørvang Andersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
